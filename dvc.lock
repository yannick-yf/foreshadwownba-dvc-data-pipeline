schema: '2.0'
stages:
  gamelog_data_acquisition:
    cmd: python3 -m src.exctract.gamelog_data_acquisition --config=params.yaml
    deps:
    - path: src/exctract/gamelog_data_acquisition.py
      hash: md5
      md5: 5de16521cd47e29f4711f5c5bdb65e6e
      size: 1921
    params:
      params.yaml:
        base:
          log_level: INFO
        gamelog_data_acquisition:
          season: 2010
          team: all
          data_type: gamelog
          output_folder: pipeline_output/gamelog
  schedule_data_acquisition:
    cmd: python3 -m src.exctract.schedule_data_acquisition --config=params.yaml
    deps:
    - path: src/exctract/schedule_data_acquisition.py
      hash: md5
      md5: 32e769b8f4ebd6d1a8f761364035c739
      size: 1934
    params:
      params.yaml:
        base:
          log_level: INFO
        schedule_data_acquisition:
          season: 2010
          team: all
          data_type: schedule
          output_folder: pipeline_output/schedule
  player_attributes_data_acquisition:
    cmd: python3 -m src.exctract.player_attributes_data_acquisition --config=params.yaml
    deps:
    - path: src/exctract/player_attributes_data_acquisition.py
      hash: md5
      md5: ed2942ad0b4297e24c26f326720eff4a
      size: 2051
    params:
      params.yaml:
        base:
          log_level: INFO
        player_attributes_data_acquisition:
          season: 2024
          team: all
          data_type: player_attributes
          output_folder: pipeline_output/player_attributes
  player_salary_data_acquisition:
    cmd: python3 -m src.exctract.player_salary_data_acquisition --config=params.yaml
    deps:
    - path: src/exctract/player_salary_data_acquisition.py
      hash: md5
      md5: 0b766b33e3db73b61884252e9df77417
      size: 4422
    params:
      params.yaml:
        base:
          log_level: INFO
        player_salary_data_acquisition:
          season: 2024
          data_type: player_salary
          output_folder: pipeline_output/player_salary
  gamelog_schedule_unification:
    cmd:
    - python3 -m src.gamelog_schedule_unification  --gamelog-data-path ./data/raw/gamelogs/
      --gamelog-name-pattern gamelog --schedule-data-path ./data/raw/schedules/ --schedule-name-pattern
      schedule --unified-file-path ./data/input --unified-file-name nba_gamelog_schedule_dataset
    deps:
    - path: ./data/raw/gamelogs/
      hash: md5
      md5: c2ed982a501704084c768246fc1a553e.dir
      size: 6405938
      nfiles: 17
    - path: ./data/raw/schedules/
      hash: md5
      md5: 082d6bc0dd86fa1555d4f9f9cf6043b9.dir
      size: 2884441
      nfiles: 17
    - path: src/gamelog_schedule_unification.py
      hash: md5
      md5: 32caf01d28dc20da9a9bdbc5d63b9655
      size: 7197
    params:
      params.yaml:
        base:
          log_level: INFO
        gamelog_schedule_unification:
          gamelogs_data_path: data/raw/gamelogs/
          gamelogs_name_pattern: gamelog
          schedules_data_path: data/raw/schedules/
          schedules_name_pattern: schedule
          unified_file_path: data/input
          unified_file_name: nba_gamelog_schedule_dataset
    outs:
    - path: ./data/input/nba_gamelog_schedule_dataset.csv
      hash: md5
      md5: 1ee06c3a1509b9bfa65462f760e16d94
      size: 9910163
  player_attributes_salaries_unification:
    cmd: python3 -m src.transform.player_attributes_salaries_unification --config=params.yaml
    deps:
    - path: src/transform/player_attributes_salaries_unification.py
      hash: md5
      md5: db69057207ecb219595a685e13478e4f
      size: 4653
    params:
      params.yaml:
        base:
          log_level: INFO
        player_attributes_salaries_unification:
          data_path: pipeline_output/final/
          file_name: player_attributes_salaries_dataset
  get_training_dataset:
    cmd:
    - aws s3 cp s3://foreshadownba/data-engineering-pipeline-output/gamelogs/ ./data/raw/gamelogs/
      --profile=ipfy --recursive
    - aws s3 cp s3://foreshadownba/data-engineering-pipeline-output/schedules/ ./data/raw/schedules/
      --profile=ipfy --recursive
    outs:
    - path: ./data/raw/gamelogs/
      hash: md5
      md5: c2ed982a501704084c768246fc1a553e.dir
      size: 6405938
      nfiles: 17
    - path: ./data/raw/schedules/
      hash: md5
      md5: 082d6bc0dd86fa1555d4f9f9cf6043b9.dir
      size: 2884441
      nfiles: 17
  pre_cleaning_dataset:
    cmd:
    - python3 -m src.pre_cleaning_dataset --input-file-folder-name ./data/input/nba_gamelog_schedule_dataset.csv
      --output-folder ./data/processed --output-file-name ./nba_games_training_dataset_pre_cleaned
    deps:
    - path: ./data/input/nba_gamelog_schedule_dataset.csv
      hash: md5
      md5: 1ee06c3a1509b9bfa65462f760e16d94
      size: 9910163
    - path: src/pre_cleaning_dataset.py
      hash: md5
      md5: f6748dede6948c7bcad84a7c647c9a84
      size: 5897
    params:
      params.yaml:
        base:
          log_level: INFO
    outs:
    - path: ./data/processed/nba_games_training_dataset_pre_cleaned.csv
      hash: md5
      md5: 7d3d7e4b4d2fa27e60ea561d06e7d111
      size: 2990696
  previous_games_average_features:
    cmd: python3 -m src.previous_games_average_features --config=params.yaml
    deps:
    - path: src/previous_games_average_features.py
      hash: md5
      md5: b5d2a97c8939937949b5e36d36d2e23a
      size: 3901
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
    outs:
    - path: ./data/processed/nba_games_training_dataset_previous_games_features.csv
      hash: md5
      md5: 8cf557557a1af1b8c7988dc3b6eb6620
      size: 57972848
  elo_features:
    cmd: python3 -m src.elo_features --config=params.yaml
    deps:
    - path: src/elo_features.py
      hash: md5
      md5: 06b6fce8f72f1408d03de4076ea0ed93
      size: 8603
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
    outs:
    - path: ./data/processed/nba_games_training_dataset_elo_features.csv
      hash: md5
      md5: cf59aeb8577a6b3145e5b1955e3300ce
      size: 116550825
  previous_games_ratio_average_features:
    cmd: python3 -m src.previous_games_ratio_average_features --config=params.yaml
    deps:
    - path: src/previous_games_ratio_average_features.py
      hash: md5
      md5: 81b2a5ee62be721fd4fd6ffca1728ada
      size: 3838
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
  features_engineering_pipeline:
    cmd:
    - python3 -m src.features_engineering_pipeline --input-file-folder-name ./data/processed/nba_games_training_dataset_pre_cleaned.csv
      --output-file-folder-name ./data/processed/nba_games_training_dataset_cleaned_w_features.csv
    deps:
    - path: ./data/processed/nba_games_training_dataset_pre_cleaned.csv
      hash: md5
      md5: 7d3d7e4b4d2fa27e60ea561d06e7d111
      size: 2990696
    - path: src/features_engineering_pipeline.py
      hash: md5
      md5: d136792c6b3ea4091790487bf6b109a6
      size: 5267
    params:
      params.yaml:
        base:
          log_level: INFO
        features_engineering_pipeline:
          output_file: data/processed/nba_games_training_dataset_cleaned_w_features
        pre_cleaning_dataset:
          output_folder: data/processed
          output_file_name: nba_games_training_dataset_pre_cleaned
    outs:
    - path: ./data/processed/nba_games_training_dataset_cleaned_w_features.csv
      hash: md5
      md5: 56f7f8ff813fe23ebe07bbe8b12dca75
      size: 15298159
  get_y_variables:
    cmd:
    - python3 -m src.get_y_variables --input-file-folder-name ./data/processed/nba_games_training_dataset_cleaned_w_features.csv
      --output-file-folder-name ./data/processed/nba_games_training_dataset_final.csv
    deps:
    - path: ./data/processed/nba_games_training_dataset_cleaned_w_features.csv
      hash: md5
      md5: 56f7f8ff813fe23ebe07bbe8b12dca75
      size: 15298159
    - path: src/get_y_variables.py
      hash: md5
      md5: 2bb152cd5c91f8264b681b480b54eb21
      size: 5183
    params:
      params.yaml:
        base:
          log_level: INFO
        get_y_variables:
          input_file: data/processed/nba_games_training_dataset_cleaned_w_features
          output_file: data/processed/nba_games_training_dataset_final
    outs:
    - path: ./data/processed/nba_games_training_dataset_final.csv
      hash: md5
      md5: eb0f45a3776aa4f844a217708f3bab42
      size: 15573665
  load_training_dataset_to_db:
    cmd: python3 -m src.load_training_dataset_to_db --config=params.yaml
    deps:
    - path: ./data/output/nba_games_training_dataset_final_post_cleaned.csv
      hash: md5
      md5: b1c2c276a56efa30ea872ab733db113f
      size: 13079039
    - path: src/load_training_dataset_to_db.py
      hash: md5
      md5: 01140095987dabcc70bf1e0e4c7658f1
      size: 2753
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
  post_cleaning_dataset:
    cmd:
    - python3 -m src.post_cleaning_dataset --input-file-folder-name ./data/processed/nba_games_training_dataset_final.csv
      --output-file-folder-name ./data/output/nba_games_training_dataset_final.csv
    deps:
    - path: ./data/processed/nba_games_training_dataset_final.csv
      hash: md5
      md5: eb0f45a3776aa4f844a217708f3bab42
      size: 15573665
    - path: src/post_cleaning_dataset.py
      hash: md5
      md5: 4b555a77c8b9872d78372a0c6455beb0
      size: 4860
    params:
      params.yaml:
        base:
          log_level: INFO
        get_y_variables:
          input_file: data/processed/nba_games_training_dataset_cleaned_w_features
          output_file: data/processed/nba_games_training_dataset_final
        post_cleaning_dataset:
          output_folder: data/output
          output_file_name: nba_games_training_dataset_final
    outs:
    - path: ./data/output/nba_games_training_dataset_final.csv
      hash: md5
      md5: e95716dcd8fcd0229bc87381b99107bb
      size: 13010442
  training_dataset_assessment:
    cmd: python3 -m src.training_dataset_assessment --config=params.yaml
    deps:
    - path: ./data/output/nba_games_training_dataset_final.csv
      hash: md5
      md5: e95716dcd8fcd0229bc87381b99107bb
      size: 13010442
    - path: src/training_dataset_assessment.py
      hash: md5
      md5: 20827672430c7140fb523b276a0c40d6
      size: 6501
    params:
      params.yaml:
        base:
          log_level: INFO
  load_training_dataset_to_csv:
    cmd: python3 -m src.load_training_dataset_to_csv --config=params.yaml
    deps:
    - path: ./data/output/nba_games_training_dataset_final_post_cleaned.csv
      hash: md5
      md5: 05699773ffaf4fce2a51fb8ce248a1f6
      size: 1331
    - path: src/load_training_dataset_to_csv.py
      hash: md5
      md5: 521a4e2f70f4c93013ed4580a672be43
      size: 1590
    params:
      params.yaml:
        base:
          log_level: INFO
  writte_final_output_to_s3:
    cmd:
    - aws s3 cp ./data/output/nba_games_training_dataset_final.csv s3://foreshadownba/dvc-data-pipeline-output/
      --profile=ipfy
    deps:
    - path: ./data/output/nba_games_training_dataset_final.csv
      hash: md5
      md5: e95716dcd8fcd0229bc87381b99107bb
      size: 13010442
