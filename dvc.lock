schema: '2.0'
stages:
  gamelog_data_acquisition:
    cmd: python3 -m src.exctract.gamelog_data_acquisition --config=params.yaml
    deps:
    - path: src/exctract/gamelog_data_acquisition.py
      hash: md5
      md5: 5de16521cd47e29f4711f5c5bdb65e6e
      size: 1921
    params:
      params.yaml:
        base:
          log_level: INFO
        gamelog_data_acquisition:
          season: 2010
          team: all
          data_type: gamelog
          output_folder: pipeline_output/gamelog
  schedule_data_acquisition:
    cmd: python3 -m src.exctract.schedule_data_acquisition --config=params.yaml
    deps:
    - path: src/exctract/schedule_data_acquisition.py
      hash: md5
      md5: 32e769b8f4ebd6d1a8f761364035c739
      size: 1934
    params:
      params.yaml:
        base:
          log_level: INFO
        schedule_data_acquisition:
          season: 2010
          team: all
          data_type: schedule
          output_folder: pipeline_output/schedule
  player_attributes_data_acquisition:
    cmd: python3 -m src.exctract.player_attributes_data_acquisition --config=params.yaml
    deps:
    - path: src/exctract/player_attributes_data_acquisition.py
      hash: md5
      md5: ed2942ad0b4297e24c26f326720eff4a
      size: 2051
    params:
      params.yaml:
        base:
          log_level: INFO
        player_attributes_data_acquisition:
          season: 2024
          team: all
          data_type: player_attributes
          output_folder: pipeline_output/player_attributes
  player_salary_data_acquisition:
    cmd: python3 -m src.exctract.player_salary_data_acquisition --config=params.yaml
    deps:
    - path: src/exctract/player_salary_data_acquisition.py
      hash: md5
      md5: 0b766b33e3db73b61884252e9df77417
      size: 4422
    params:
      params.yaml:
        base:
          log_level: INFO
        player_salary_data_acquisition:
          season: 2024
          data_type: player_salary
          output_folder: pipeline_output/player_salary
  gamelog_schedule_unification:
    cmd:
    - python3 -m src.gamelog_schedule_unification  --gamelog-data-path ./data/raw/gamelogs/
      --gamelog-name-pattern gamelog --schedule-data-path ./data/raw/schedules/ --schedule-name-pattern
      schedule --unified-file-path ./data/input --unified-file-name nba_gamelog_schedule_dataset
    deps:
    - path: src/gamelog_schedule_unification.py
      hash: md5
      md5: 56960a059b457cabc55ef1b451fdd188
      size: 6548
    params:
      params.yaml:
        base:
          log_level: INFO
        gamelog_schedule_unification:
          gamelogs_data_path: data/raw/gamelogs/
          gamelogs_name_pattern: gamelog
          schedules_data_path: data/raw/schedules/
          schedules_name_pattern: schedule
          unified_file_path: data/input
          unified_file_name: nba_gamelog_schedule_dataset
    outs:
    - path: ./data/input/nba_gamelog_schedule_dataset.csv
      hash: md5
      md5: 7aac418a032f00a41da716cb43fc6f0e
      size: 7174862
  player_attributes_salaries_unification:
    cmd: python3 -m src.transform.player_attributes_salaries_unification --config=params.yaml
    deps:
    - path: src/transform/player_attributes_salaries_unification.py
      hash: md5
      md5: db69057207ecb219595a685e13478e4f
      size: 4653
    params:
      params.yaml:
        base:
          log_level: INFO
        player_attributes_salaries_unification:
          data_path: pipeline_output/final/
          file_name: player_attributes_salaries_dataset
  get_training_dataset:
    cmd:
    - aws s3 cp s3://foreshadownba/data-engineering-pipeline-output/gamelogs/ ./data/raw/gamelogs/
      --profile=ipfy --recursive
    - aws s3 cp s3://foreshadownba/data-engineering-pipeline-output/schedules/ ./data/raw/schedules/
      --profile=ipfy --recursive
    outs:
    - path: ./data/raw/gamelogs/
      hash: md5
      md5: 31ab49365beb150ab9b61160ba910852.dir
      size: 6382176
      nfiles: 17
    - path: ./data/raw/schedules/
      hash: md5
      md5: 09ae2e435bdcab18b3341450a43d7c5f.dir
      size: 2881620
      nfiles: 17
  pre_cleaning_dataset:
    cmd:
    - python3 -m src.pre_cleaning_dataset --input-file-folder-name ./data/input/nba_gamelog_schedule_dataset.csv
      --output-folder ./data/processed --output-file-name ./nba_games_training_dataset_pre_cleaned
    deps:
    - path: ./data/input/nba_gamelog_schedule_dataset.csv
      hash: md5
      md5: 7aac418a032f00a41da716cb43fc6f0e
      size: 7174862
    - path: src/pre_cleaning_dataset.py
      hash: md5
      md5: 5328120b34637a93d7dcf5d98e548f80
      size: 4339
    params:
      params.yaml:
        base:
          log_level: INFO
    outs:
    - path: ./data/processed/nba_games_training_dataset_pre_cleaned.csv
      hash: md5
      md5: ab7d956d959ebb1f8d3b192fa53036f3
      size: 2748978
  previous_games_average_features:
    cmd: python3 -m src.previous_games_average_features --config=params.yaml
    deps:
    - path: src/previous_games_average_features.py
      hash: md5
      md5: b5d2a97c8939937949b5e36d36d2e23a
      size: 3901
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
    outs:
    - path: ./data/processed/nba_games_training_dataset_previous_games_features.csv
      hash: md5
      md5: 8cf557557a1af1b8c7988dc3b6eb6620
      size: 57972848
  elo_features:
    cmd: python3 -m src.elo_features --config=params.yaml
    deps:
    - path: src/elo_features.py
      hash: md5
      md5: 06b6fce8f72f1408d03de4076ea0ed93
      size: 8603
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
    outs:
    - path: ./data/processed/nba_games_training_dataset_elo_features.csv
      hash: md5
      md5: cf59aeb8577a6b3145e5b1955e3300ce
      size: 116550825
  previous_games_ratio_average_features:
    cmd: python3 -m src.previous_games_ratio_average_features --config=params.yaml
    deps:
    - path: src/previous_games_ratio_average_features.py
      hash: md5
      md5: 81b2a5ee62be721fd4fd6ffca1728ada
      size: 3838
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
  features_engineering_pipeline:
    cmd: python3 -m src.features_engineering --config=params.yaml
    deps:
    - path: ./data/processed/nba_games_training_dataset_pre_cleaned.csv
      hash: md5
      md5: 0d7db7b3d4886f4d0015bcb536395a34
      size: 2567650
    - path: src/features_engineering.py
      hash: md5
      md5: 84fc9d393183c99ae9a0d48b35d537ca
      size: 3987
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
    outs:
    - path: ./data/processed/nba_games_training_dataset_cleaned_w_features.csv
      hash: md5
      md5: eae0d6995d2318f43735276b76c95fe2
      size: 14419733
  get_y_variables:
    cmd: python3 -m src.get_y_variables --config=params.yaml
    deps:
    - path: ./data/processed/nba_games_training_dataset_cleaned_w_features.csv
      hash: md5
      md5: eae0d6995d2318f43735276b76c95fe2
      size: 14419733
    - path: src/get_y_variables.py
      hash: md5
      md5: 047af8ec7baaae1fb4d25a13951d54e7
      size: 4148
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
    outs:
    - path: ./data/processed/nba_games_training_dataset_final.csv
      hash: md5
      md5: bc5eb247bc2df9ceac6c7e9bbf95fa1a
      size: 14674817
  load_training_dataset_to_db:
    cmd: python3 -m src.load_training_dataset_to_db --config=params.yaml
    deps:
    - path: ./data/output/nba_games_training_dataset_final_post_cleaned.csv
      hash: md5
      md5: b1c2c276a56efa30ea872ab733db113f
      size: 13079039
    - path: src/load_training_dataset_to_db.py
      hash: md5
      md5: 01140095987dabcc70bf1e0e4c7658f1
      size: 2753
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
  post_cleaning_dataset:
    cmd: python3 -m src.post_cleaning_dataset --config=params.yaml
    deps:
    - path: ./data/processed/nba_games_training_dataset_final.csv
      hash: md5
      md5: bc5eb247bc2df9ceac6c7e9bbf95fa1a
      size: 14674817
    - path: src/post_cleaning_dataset.py
      hash: md5
      md5: 0a26967d9cfd76482944717d8faa07de
      size: 1859
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
    outs:
    - path: ./data/output/nba_games_training_dataset_final_post_cleaned.csv
      hash: md5
      md5: b1c2c276a56efa30ea872ab733db113f
      size: 13079039
  training_dataset_assessment:
    cmd: python3 -m src.training_dataset_assessment --config=params.yaml
    deps:
    - path: ./data/output/nba_games_training_dataset_final_post_cleaned.csv
      hash: md5
      md5: b1c2c276a56efa30ea872ab733db113f
      size: 13079039
    - path: src/training_dataset_assessment.py
      hash: md5
      md5: abb98e97971c39c668e37ba8fd8707f8
      size: 38817
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
  load_training_dataset_to_csv:
    cmd: python3 -m src.load_training_dataset_to_csv --config=params.yaml
    deps:
    - path: ./data/output/nba_games_training_dataset_final_post_cleaned.csv
      hash: md5
      md5: b1c2c276a56efa30ea872ab733db113f
      size: 13079039
    - path: src/load_training_dataset_to_csv.py
      hash: md5
      md5: 521a4e2f70f4c93013ed4580a672be43
      size: 1590
    params:
      params.yaml:
        base:
          log_level: INFO
        get_training_dataset:
          nba_games_training_dataset: nba_games_training_dataset
          player_attributes_salaries_dataset: player_attributes_salaries_dataset
